x1 = [8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 65536 131072 262144 524288 1048576 2097152 4194304 8388608 16777216 33554432 67108864 134217728 268435456 536870912 1073741824];
y1 = [0.000000764 0.000000291 0.000000258 0.000000257 0.000000321 0.000000412 0.000000610 0.000000826 0.000001183 0.000001837 0.000000737 0.000001124 0.000001943 0.000003385 0.000006696 0.000013735 0.000022930 0.000036924 0.000063771 0.000119368 0.000515127 0.001531805 0.002658832 0.004758105 0.008700264 0.016260280 0.032271405 0.064023911];

x2 = [8 16 32 64 128 256 512 1024 2048 4096 8192 16384 32768 65536 131072 262144 524288 1048576 2097152 4194304 8388608 16777216 33554432 67108864 134217728 268435456 536870912 1073741824];
y2 = [0.000006639 0.000002493 0.000002458 0.000002542 0.000003115 0.000003258 0.000003231 0.000003348 0.000003554 0.000003719 0.000004159 0.000004643 0.000007876 0.000010861 0.000016196 0.000026786 0.000040416 0.000074401 0.000134118 0.000239264 0.000404240 0.000983579 0.001972963 0.003498897 0.007580262 0.012866279 0.025727864 0.046204370];

x1 = x1(15:end);
y1 = y1(15:end);

x2 = x2(15:end);
y2 = y2(10:end);

p1 = polyfit(x1, y1, 1);
p2 = polyfit(x2, y2, 1);

1/p1(1)
p1(2)
1/p2(1)
p2(2)


% Plotting the data
loglog(x1, y1, 'ro', 'MarkerSize', 8); % Plotting data points for y1
hold on;
loglog(x2, y2, 'bo', 'MarkerSize', 8); % Plotting data points for y2

% Plotting the polyfits
x = logspace(log10(min(x1)), log10(max(x2)), 100); % Generating x values for the polyfits
y1_fit = polyval(p1, x); % Evaluating the polyfit for y1
y2_fit = polyval(p2, x); % Evaluating the polyfit for y2
loglog(x, y1_fit, 'r-', 'LineWidth', 2); % Plotting the polyfit for y1
loglog(x, y2_fit, 'b-', 'LineWidth', 2); % Plotting the polyfit for y2

% Adding labels and legend
xlabel('x');
ylabel('y');
legend('Data 1', 'Data 2', 'Polyfit 1', 'Polyfit 2');

hold off;



